# Автоматизированные тесты Pingwin Casino

Проект содержит end-to-end тесты на Playwright для проверки функциональности сайта [Pingwin Casino](https://pingwincasino24.com).

## Структура проекта

- `pages/` – Page Object модели страниц и модальных окон.
- `tests/` – сами тесты, сгруппированные по разделам сайта.
- `fixtures/` – вспомогательные данные и хелперы.
- `storage/` – сохранённые состояния браузера для авторизованных пользователей.
- `global-setup.ts` – предварительный прогон, который логинит пользователей и собирает данные о способах оплаты.
- `playwright.config.ts` – общая конфигурация Playwright и описание проектов браузеров.

## Подготовка окружения

1. Установите Node.js (желательно последнюю LTS-версию).
2. Выполните команду `npm install` для установки зависимостей.
3. Выполните команду `npx playwright install` для установки браузеров
4. Создайте файл `.env` на основе `.env.example` и заполните **своими** тестовыми данными:

## Запуск тестов

- Все тесты: `npm test` или `npx playwright test`.
- Конкретный файл: `npx playwright test tests/auth/login.spec.ts`.
- Конкретный браузер: `npx playwright test --project=chromium`.
- Проект `webkit` (Safari) работает **очень медленно**. Запускайте его только при реальной необходимости: `npx playwright test --project=webkit`.
- Для наглядного запуска можно добавить ключ `--headed`.

## Анализ результатов

- После выполнения тестов создаётся HTML‑отчёт в папке `playwright-report/`. Обычно он сразу же открывается в браузере и его не нужно отдельно как-то запускать.
- Открыть отчёт: `npm run show-report` или `npx playwright show-report`.
- Подробные лог‑файлы, скриншоты и трассировки лежат в `test-results/`.
- В случае падения теста изучите отчет, скриншоты и trace‑файлы, которое лежат внутри отчета.

## Доп. информация:

- Перед запуском тестов важно открыть файл `.env` и заменить данные на свои.
  - MAILSLURP_API_KEY: API ключ можно получить тут: https://app.mailslurp.com/dashboard/. Важный момент: у сервиса есть лимиты. В месяц можно вызвать около 200 запросов, чего должно хватить, по идее. Если не будет хватать - просто создаете новый аккаунт и получаете новый ключ.
  - VALID_USER_EMAIL & VALID_USER_PASSWORD: сюда записать данные для входа в аккаунт с подтвержденной почтой
  - EXISTING_PHONE_USER_PHONE & EXISTING_PHONE_USER_PASSWORD: сюда записать данные для входа в аккаунт, который был зарегистрирован через номер телефона. Номер телефона подтверждать не обязательно.
  - WITHDRAWAL_USER_EMAIL & WITHDRAWAL_USER_PASSWORD: это данные от аккаунта, который содержит баланс $20. Эти данные можно не менять на другие
- Аккаунты, которые используются в тестах, переодически банятся. Одного аккаунта может хватить на 10-30 запусков всех тестов, судя по наблюдениям. В идеале важно создать white list аккаунтов, которые не будут баниться. Иначе придется менять учетные данные часто
